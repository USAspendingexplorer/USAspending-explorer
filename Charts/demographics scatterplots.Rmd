---
title: "demographics scatterplots"
author: "Linnea Powell"
date: "June 16, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(shiny)
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(plotly)
```

```{r}
dem <- readRDS( gzcon(url("https://github.com/USAspendingexplorer/USAspending-explorer/blob/master/Data/Processed/NYcensus.rds?raw=true")))

# select only necessary columns
dem2<-select(dem, county.name, Pop, MHincome, pov.rate)

dem2 <- mutate(dem2, pov.rate = paste(round(100*pov.rate, 1), "%", sep=""))

dem2 <- mutate(dem2, MHincome = paste("$",format(MHincome, big.mark=","),sep=""))


```


```{r}
hovertxt <- paste("County:",dem2$county.name, "
", "Population:",dem2$Pop)

plot_ly(data = dem2, x = ~county.name, y = ~Pop, name = "",
        marker = list(color = "#737373", size = 7))%>%
add_markers(hoverinfo="text", text=hovertxt) %>%
layout(xaxis = list(title = 'County', showticklabels=FALSE, showgrid=FALSE),
      yaxis = list(title = 'Population', showgrid=FALSE))
```


```{r}
hovertxt2 <- paste("County:",dem2$county.name, "
", "Median Household Income:",dem2$MHincome)

plot_ly(data = dem2, x = ~county.name, y = ~MHincome, name = "",
        marker = list(color = "#737373", size = 7))%>%
add_markers(hoverinfo="text", text=hovertxt2) %>%
layout(xaxis = list(title = 'County', showticklabels=FALSE, showgrid=FALSE),
      yaxis = list(title = 'Median Household Income', showgrid=FALSE, showticklabels=FALSE))


```


```{r}
hovertxt3 <- paste("County:",dem2$county.name, "
", "Poverty Rate:",dem2$pov.rate)

plot_ly(data = dem2, x = ~county.name, y = ~pov.rate, name = "",
        marker = list(color = "#737373", size = 7))%>%
add_markers(hoverinfo="text", text=hovertxt3) %>%
layout(xaxis = list(title = 'County', showticklabels=FALSE, showgrid=FALSE),
      yaxis =list(title = 'Poverty Rate', showgrid=FALSE, showticklabels=FALSE))


```


